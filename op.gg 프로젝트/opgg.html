<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

  <link rel="stylesheet" href="/op.gg 프로젝트/opgg.css">
</head>
<body>
  <div id="container">
    <!-- 검색 -->
    <div id="search_menu">

      <div id="search_bar">
        <input class="search_name" type="text" value="아기토끼#냐영토끼" placeholder="Riot ID 검색">
        <button id="search_button">검색</button>
      </div>

    </div>

    <!-- 플레이어 정보 -->
    <div id="player_menu">

      <div id="player">
        <div id="player_icon">
          <img src="https://opgg-static.akamaized.net/meta/images/profile_icons/profileIcon6634.jpg" alt="">
          <div id="player_level"><span>100</span></div>
        </div>
        
        <div id="player_info">
          <h1><span id="nickname">닉네임</span><span id="tag">#태그</span></h1>
        </div>

      </div>
    </div>

    <div id="integrate">

      <div id="rank_info">
        <section id="solo_rank">
          <h5>솔로랭크</h5>
          <hr>
          <img src="https://opgg-static.akamaized.net/images/medals_new/challenger.png?image=q_auto,f_webp,w_144&v=1721451321478" alt="솔랭티어">
          <span class="win">0</span>승 <span class="lose">0</span>패 / <span class="rate">0</span> %
        </section>
    
        <section id="flex_rank">
          <h5>자유랭크</h5>
          <hr>
          <img src="https://opgg-static.akamaized.net/images/medals_new/challenger.png?image=q_auto,f_webp,w_144&v=1721451321478" alt="자랭티어">
          <span class="win">0</span>승 <span class="lose">0</span>패 / <span class="rate">0</span> %
        </section>
      </div>

      <div id="summary_info">
        <!-- 최근 20게임 요약 정보 -->
        <div id="summary_menu">
          <div id="record">
            전적
            <h2><span class="win">0</span>승 <span class="lose">0</span>패 / <span class="rate">0</span> %</h2>
            <h2>KDA <span class="KDA">0</span></h2>
            <p><span class="kill">0</span> / <span class="death">0</span> / <span class="assist">0</span></ㅔ>
          </div>

          <div id="latest_champion">
            최근 챔피언
          </div>

          <div id="latest_position">
            <p>최근 포지션</p>
            <div id="position_data">
              <div id="top">
                <img src="https://s-lol-web.op.gg/images/icon/icon-position-top.svg" alt="top">
                <br>
                <span>0</span>
              </div>
  
              <div id="jungle">
                <img src="https://s-lol-web.op.gg/images/icon/icon-position-jungle.svg" alt="jungle">
                <br>
                <span>0</span>
              </div>
  
              <div id="mid">
                <img src="https://s-lol-web.op.gg/images/icon/icon-position-mid.svg" alt="mid">
                <br>
                <span>0</span>
              </div>
  
              <div id="bot">
                <img src="https://s-lol-web.op.gg/images/icon/icon-position-adc.svg" alt="bot">
                <br>
                <span>0</span>
              </div>
  
              <div id="supporter">
                <img src="https://s-lol-web.op.gg/images/icon/icon-position-support.svg" alt="supporter">
                <br>
                <span>0</span>
              </div>
  
              <div id="etc">
                <img src="https://s-lol-web.op.gg/images/icon/icon-position-all.svg" alt="etc">
                <br>
                <span>0</span>
              </div>
            </div>
            
          </div>
        </div>
  
        <!-- 20개 게임 각각의 정보 -->
        <div id="game20_menu">
          <div class="game victory">

            <div class="simple_data">
              <h5 class="mod">자유랭크</h5>
              <p class="time">5시간 전</p>
              <hr>
              <p class="result">패배</p>
              <p class="playtime">15분 13초</p>
            </div>
            

            <div class="champion">
              <div class="game_data">
                <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/champion/Aurora.png" class="champion_icon" alt="chamption">

                <div class="champion_level">10</div>

                <img src="https://s-lol-web.op.gg/images/icon/icon-position-adc.svg" class="champion_position" alt="">

                <div class="spell">
                  <div class="spell_div spell1">
                    <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/spell/SummonerBarrier.png" class="d_spell" alt="">
                  </div>

                  <div class="spell_div spell2">
                    <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/spell/SummonerFlash.png" class="f_spell" alt="">
                  </div>
                </div>

                <div class="rune">
                  <div class="rune_div rune_1">
                    <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/perk/8021.png" class="rune1" alt="">
                  </div>
                  
                  <div class="rune_div rune_2">
                    <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/perkStyle/8200.png" class="rune2" alt="">
                  </div>
                </div>
  
                <div class="score1">
                  <p class="kda_area1"><span class="kill">0</span> / <span class="death">0</span> / <span class="assist">0</span></p>
                  <p class="kda_area2"><span class="kda">0.0</span> KDA</p>
                </div>
              </div>


              <div class="item">
                <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/item/3087.png" class="item1" alt="item1">
                <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/item/3087.png" class="item2" alt="item2">
                <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/item/3087.png" class="item3" alt="item3">
                <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/item/3087.png" class="item4" alt="item4">
                <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/item/3087.png" class="item5" alt="item5">
                <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/item/3087.png" class="item6" alt="item6">
                <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/item/3340.png" class="item7" alt="item7">
              </div>
            </div>

            <div class="score2">
              <p>GOLD <span class="gold">0</span></p>
              <p>CS <span class="cs">0</span></p>
              <div class="multikill">펜타킬</div>
            </div>

            <div class="users">
              <div class="team1">
                <p class="user1">유저1</p>
                <p class="user2">유저2</p>
                <p class="user3">유저3</p>
                <p class="user4">유저4</p>
                <p class="user5">유저5</p>
              </div>

              <div class="team2">
                <p class="user1">유저1</p>
                <p class="user2">유저2</p>
                <p class="user3">유저3</p>
                <p class="user4">유저4</p>
                <p class="user5">유저5</p>
              </div>
            </div>
            
          </div>

          <div class="game defeat">

            <div class="simple_data">
              <h5 class="mod">자유랭크</h5>
              <p class="time">5시간 전</p>
              <hr>
              <p class="result">패배</p>
              <p class="playtime">15분 13초</p>
            </div>

            <div class="champion">
              <div class="game_data">
                <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/champion/Aurora.png" class="champion_icon" alt="chamption">

                <div class="champion_level">10</div>

                <img src="https://s-lol-web.op.gg/images/icon/icon-position-adc.svg" class="champion_position" alt="">

                <div class="spell">
                  <div class="spell_div spell1">
                    <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/spell/SummonerBarrier.png" class="d_spell" alt="">
                  </div>

                  <div class="spell_div spell2">
                    <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/spell/SummonerFlash.png" class="f_spell" alt="">
                  </div>
                </div>

                <div class="rune">
                  <div class="rune_div rune_1">
                    <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/perk/8021.png" class="rune1" alt="">
                  </div>
                  
                  <div class="rune_div rune_2">
                    <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/perkStyle/8200.png" class="rune2" alt="">
                  </div>
                </div>
  
                <div class="score1">
                  <p class="kda_area1"><span class="kill">0</span> / <span class="death">0</span> / <span class="assist">0</span></p>
                  <p class="kda_area2"><span class="kda">0.0</span> KDA</p>
                </div>
              </div>


              <div class="item">
                <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/item/3087.png" class="item1" alt="item1">
                <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/item/3087.png" class="item2" alt="item2">
                <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/item/3087.png" class="item3" alt="item3">
                <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/item/3087.png" class="item4" alt="item4">
                <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/item/3087.png" class="item5" alt="item5">
                <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/item/3087.png" class="item6" alt="item6">
                <img src="https://opgg-static.akamaized.net/meta/images/lol/14.14.1/item/3340.png" class="item7" alt="item7">
              </div>
            </div>

            <div class="score2">
              <p>GOLD <span class="gold">0</span></p>
              <p>CS <span class="cs">0</span></p>
              <div class="multikill">펜타킬</div>
            </div>

            <div class="users">
              <div class="team1">
                <p class="user1">유저1</p>
                <p class="user2">유저2</p>
                <p class="user3">유저3</p>
                <p class="user4">유저4</p>
                <p class="user5">유저5</p>
              </div>

              <div class="team2">
                <p class="user1">유저1</p>
                <p class="user2">유저2</p>
                <p class="user3">유저3</p>
                <p class="user4">유저4</p>
                <p class="user5">유저5</p>
              </div>
            </div>
            
          </div>

        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script>

    const API_KEY = "RGAPI-26f88084-cbc0-4e38-bbbd-659b4da89888"
    let puuid
    let summoner_level
    let profile_icon
    let id

    // 검색 버튼에 클릭하면 모든 검색이 실행 된다.
    const search_button = document.querySelector("#search_button")
    search_button.addEventListener("click", async function() { // 검색버튼 클릭하면 이벤트 실행
      try {
        // 1. ACCOUNT API 들어가기 : puuid
        let name = document.querySelector(".search_name").value.split("#")
        let gameName = name[0]
        let tagline = name[1]

        const accountResponse = await axios.get(`https://asia.api.riotgames.com/riot/account/v1/accounts/by-riot-id/${gameName}/${tagline}?api_key=${API_KEY}`)
        puuid = accountResponse.data.puuid
        console.log(puuid)

        document.querySelector("#nickname").textContent = accountResponse.data.gameName
        document.querySelector("#tag").textContent = "#" + accountResponse.data.tagLine

        // 2. SUMMONER API 들어가기 : 유저의 레벨, 프로필이미지, id
        const summonerResponse = await axios.get(`https://kr.api.riotgames.com/lol/summoner/v4/summoners/by-puuid/${puuid}?api_key=${API_KEY}`)
        console.log(summonerResponse)
        summoner_level = summonerResponse.data.summonerLevel
        profile_icon = summonerResponse.data.profileIconId
        id = summonerResponse.data.id

        document.querySelector("#player_level span").textContent = summoner_level // 레벨 변경
        document.querySelector("#player_icon img").setAttribute("src", `https://opgg-static.akamaized.net/meta/images/profile_icons/profileIcon${profile_icon}.jpg`) // 프로필 사진 변경


        // 3-1 LEAGUE API 들어가기 : 티어, 승패 등등의 전적
        const leagueResponse = await axios.get(`https://kr.api.riotgames.com/lol/league/v4/entries/by-summoner/${id}?api_key=${API_KEY}`);
        console.log(leagueResponse);

        let soloRankData = null;
        let flexRankData = null;

        // 각 queueType에 맞는 데이터를 찾기
        for (let i = 0; i < leagueResponse.data.length; i++) {
          if (leagueResponse.data[i].queueType === 'RANKED_SOLO_5x5') {
            soloRankData = leagueResponse.data[i];
          } else if (leagueResponse.data[i].queueType === 'RANKED_FLEX_SR') {
            flexRankData = leagueResponse.data[i];
          }
        }

        // 솔로 랭크 데이터 처리
        if (soloRankData) {
          const solo_rank_tier_img = document.querySelector("#solo_rank img");
          solo_rank_tier_img.setAttribute("src", `https://opgg-static.akamaized.net/images/medals_new/${soloRankData.tier.toLowerCase()}.png?image=q_auto,f_webp,w_144&v=1721451321478`);
        
          document.querySelector("#solo_rank .win").textContent = soloRankData.wins; // 솔랭 승리
          document.querySelector("#solo_rank .lose").textContent = soloRankData.losses; // 솔랭 패배
          document.querySelector("#solo_rank .rate").textContent = ((soloRankData.wins / (soloRankData.wins + soloRankData.losses)) * 100).toFixed(2); // 솔랭 승률
        }

        // 자랭 데이터 처리
        if (flexRankData) {
          const flex_rank_tier_img = document.querySelector("#flex_rank img");
          flex_rank_tier_img.setAttribute("src", `https://opgg-static.akamaized.net/images/medals_new/${flexRankData.tier.toLowerCase()}.png?image=q_auto,f_webp,w_144&v=1721451321478`);
        
          document.querySelector("#flex_rank .win").textContent = flexRankData.wins; // 자랭 승리
          document.querySelector("#flex_rank .lose").textContent = flexRankData.losses; // 자랭 패배
          document.querySelector("#flex_rank .rate").textContent = ((flexRankData.wins / (flexRankData.wins + flexRankData.losses)) * 100).toFixed(2); // 자랭 승률
        }



        // 3-2. MATCH API 들어감 : puuid로 20개 게임 불러오기
        // 여기서 적절한 API 호출 및 처리 추가

      } catch (error) {
        console.error(error)
      }
    })

  </script>
</body>
</html>